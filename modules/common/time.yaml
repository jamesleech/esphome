# anti burn time variables
switch:
  - platform: template
    name: Antiburn
    id: switch_antiburn
    icon: mdi:television-shimmer
    optimistic: true
    entity_category: "config"
    turn_on_action:
      - logger.log: "Starting Antiburn"
      - if:
          condition: lvgl.is_paused
          then:
            - lvgl.resume:
            - lvgl.widget.redraw:
      - lvgl.pause:
          show_snow: true
    turn_off_action:
      - logger.log: "Stopping Antiburn"
      - if:
          condition: lvgl.is_paused
          then:
            - lvgl.resume:
            - lvgl.widget.redraw:

time:
  - platform: homeassistant
    id: homeassistant_time # Add an ID to reference the time component
    on_time_sync:
      then:
        - logger.log: "time sync"
        - lvgl.label.update:
            id: lbl_page_time
            text:
              time_format: ${time_format}
              time: homeassistant_time # Explicitly reference the time component ID
    on_time:
      - minutes: "*"
        seconds: 0
        then:
          - logger.log:
              format: "time tick: %s"
              args:
                [
                  'id(homeassistant_time).now().strftime("%Y-%m-%d %H:%M:%S").c_str()',
                ]
          - lvgl.label.update:
              id: lbl_page_time
              text:
                time_format: ${time_format}
                time: homeassistant_time # Explicitly reference the time component ID
      - hours: 2,3,4,5
        minutes: 5
        seconds: 0
        then:
          - switch.turn_on: switch_antiburn
      - hours: 2,3,4,5
        minutes: 35
        seconds: 0
        then:
          - switch.turn_off: switch_antiburn
